<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <apiVersion>64.0</apiVersion>
    <decisions>
        <name>Are_We_Doing_Anything_with_this_Record</name>
        <label>Are We Doing Anything with this Record</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <defaultConnectorLabel>No Not Doing Anything</defaultConnectorLabel>
        <rules>
            <name>Yes_We_Are_Doing_Things</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_Vendor_and_Vendor_Customization.Outputs.VendorRecord.Name</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Verizon</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Update_Contact_ECC_Record</targetReference>
            </connector>
            <label>Yes - Verizon</label>
        </rules>
    </decisions>
    <decisions>
        <name>Is_Contact_Signer_of_Contract</name>
        <label>Is Contact Signer of Contract</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <defaultConnectorLabel>No - Contact is Not Signer of Contract</defaultConnectorLabel>
        <rules>
            <name>Yes_Contact_is_Signer_of_Contract</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_Onboarding_Records_on_Account.Outputs.OnboardingRecord.Contract__r.Principal_Owner__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>$Record.POE_Contact__c</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Execute_Required_Steps</targetReference>
            </connector>
            <label>Yes - Contact is Signer of Contract</label>
        </rules>
    </decisions>
    <decisions>
        <name>Is_ECC_Record_SSO_ID</name>
        <label>Is ECC Record SSO ID</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <defaultConnector>
            <targetReference>Update_ECC_Process_Status</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No - Trigger is not SSO ID</defaultConnectorLabel>
        <rules>
            <name>Yes_ECC_Record_is_SSO_ID</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.External_Contact_Credential_Type__r.Name</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>SSO ID</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Is_SSO_ID_Setup_Complete</targetReference>
            </connector>
            <label>Yes - ECC Record is SSO ID</label>
        </rules>
    </decisions>
    <decisions>
        <name>Is_SSO_ID_Setup_Complete</name>
        <label>Is SSO ID Setup Complete</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <defaultConnectorLabel>No - SSO ID</defaultConnectorLabel>
        <rules>
            <name>Yes_SSO_ID</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.POE_Process_Status__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Training Sent</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_Onboarding_Record_If_Available</targetReference>
            </connector>
            <label>Yes - SSO ID</label>
        </rules>
    </decisions>
    <description>Business Logic Layer - External Contact Credential Object - Record Trigger - Execute Supplemental Onboarding Requirements</description>
    <environments>Default</environments>
    <interviewLabel>BLL - External Contact Credential - RCD - Execute Onboarding Requirement {!$Flow.CurrentDateTime}</interviewLabel>
    <label>BLL - External Contact Credential - RCD - Execute Supplemental Onboarding Requirements</label>
    <orchestratedStages>
        <name>Execute_Required_Steps</name>
        <label>Execute Required Steps</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <exitConditionLogic>and</exitConditionLogic>
        <stageSteps>
            <name>Execute_Required_Steps_Flow</name>
            <actionName>DOMAIN_External_Contact_Credential_SFL_Send_Email_Communication</actionName>
            <actionType>stepBackground</actionType>
            <entryConditionLogic>and</entryConditionLogic>
            <exitConditionLogic>and</exitConditionLogic>
            <inputParameters>
                <name>ContactRecord</name>
                <value>
                    <elementReference>Get_Contact_Account_Record.Outputs.ContactRecord</elementReference>
                </value>
            </inputParameters>
            <inputParameters>
                <name>ExternalContactCredential</name>
                <value>
                    <elementReference>$Record</elementReference>
                </value>
            </inputParameters>
            <label>Execute Required Steps Flow</label>
            <requiresAsyncProcessing>false</requiresAsyncProcessing>
            <runAsUser>false</runAsUser>
            <stepSubtype>BackgroundStep</stepSubtype>
        </stageSteps>
    </orchestratedStages>
    <orchestratedStages>
        <name>Get_Onboarding_Record_If_Available</name>
        <label>Get Onboarding Record If Available</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <connector>
            <targetReference>Is_Contact_Signer_of_Contract</targetReference>
        </connector>
        <exitConditionLogic>and</exitConditionLogic>
        <stageSteps>
            <name>Get_Onboarding_Records_on_Account</name>
            <actionName>DOMAIN_Onboarding_SFL_Get_Records</actionName>
            <actionType>stepBackground</actionType>
            <entryConditionLogic>and</entryConditionLogic>
            <exitConditionLogic>and</exitConditionLogic>
            <inputParameters>
                <name>AccountRecord</name>
                <value>
                    <elementReference>Get_Contact_Account_Record.Outputs.AccountRecord</elementReference>
                </value>
            </inputParameters>
            <inputParameters>
                <name>VerizonVendorId</name>
                <value>
                    <elementReference>Get_Vendor_and_Vendor_Customization.Outputs.VendorRecord.Id</elementReference>
                </value>
            </inputParameters>
            <label>Get Onboarding Records on Account</label>
            <requiresAsyncProcessing>false</requiresAsyncProcessing>
            <runAsUser>false</runAsUser>
            <stepSubtype>BackgroundStep</stepSubtype>
        </stageSteps>
    </orchestratedStages>
    <orchestratedStages>
        <name>Get_Related_Record_Information</name>
        <label>Get Related Record Information</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <connector>
            <targetReference>Are_We_Doing_Anything_with_this_Record</targetReference>
        </connector>
        <exitConditionLogic>and</exitConditionLogic>
        <stageSteps>
            <name>Get_Vendor_and_Vendor_Customization</name>
            <actionName>DOMAIN_External_Contact_Credential_SFL_GET_Vendor_Customization</actionName>
            <actionType>stepBackground</actionType>
            <entryConditionLogic>and</entryConditionLogic>
            <exitConditionLogic>and</exitConditionLogic>
            <inputParameters>
                <name>ExternalContactCredentialRecord</name>
                <value>
                    <elementReference>$Record</elementReference>
                </value>
            </inputParameters>
            <label>Get Vendor and Vendor Customization</label>
            <requiresAsyncProcessing>false</requiresAsyncProcessing>
            <runAsUser>false</runAsUser>
            <stepSubtype>BackgroundStep</stepSubtype>
        </stageSteps>
        <stageSteps>
            <name>Get_Contact_Account_Record</name>
            <actionName>DOMAIN_External_Contact_Credential_SFL_GET_Contact_Record</actionName>
            <actionType>stepBackground</actionType>
            <entryConditionLogic>and</entryConditionLogic>
            <exitConditionLogic>and</exitConditionLogic>
            <inputParameters>
                <name>ContactId</name>
                <value>
                    <elementReference>$Record.POE_Contact__c</elementReference>
                </value>
            </inputParameters>
            <label>Get Contact &amp; Account Record</label>
            <requiresAsyncProcessing>false</requiresAsyncProcessing>
            <runAsUser>false</runAsUser>
            <stepSubtype>BackgroundStep</stepSubtype>
        </stageSteps>
    </orchestratedStages>
    <orchestratedStages>
        <name>Update_Contact_ECC_Record</name>
        <label>Update Contact ECC Fields Record</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <connector>
            <targetReference>Is_ECC_Record_SSO_ID</targetReference>
        </connector>
        <exitConditionLogic>and</exitConditionLogic>
        <stageSteps>
            <name>Update_Contact_ECC_Fields_Record_Flow</name>
            <actionName>DOMAIN_Contact_SFL_UPDATE_Contact_Fields_with_ECC_Information</actionName>
            <actionType>stepBackground</actionType>
            <entryConditionLogic>and</entryConditionLogic>
            <exitConditionLogic>and</exitConditionLogic>
            <inputParameters>
                <name>ContactRecord</name>
                <value>
                    <elementReference>Get_Contact_Account_Record.Outputs.ContactRecord</elementReference>
                </value>
            </inputParameters>
            <inputParameters>
                <name>ECCRecord</name>
                <value>
                    <elementReference>$Record</elementReference>
                </value>
            </inputParameters>
            <inputParameters>
                <name>ECCRecordTypeName</name>
                <value>
                    <elementReference>$Record.External_Contact_Credential_Type__r.Name</elementReference>
                </value>
            </inputParameters>
            <label>Update Contact ECC Fields Record Flow</label>
            <requiresAsyncProcessing>false</requiresAsyncProcessing>
            <runAsUser>false</runAsUser>
            <stepSubtype>BackgroundStep</stepSubtype>
        </stageSteps>
    </orchestratedStages>
    <orchestratedStages>
        <name>Update_ECC_Process_Status</name>
        <label>Update ECC Process Status</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <exitConditionLogic>and</exitConditionLogic>
        <stageSteps>
            <name>Update_ECC_Process_Status_Flow</name>
            <actionName>DOMAIN_External_Contact_Credential_SFL_UPDATE_Process_Status_Per_Business</actionName>
            <actionType>stepBackground</actionType>
            <entryConditionLogic>and</entryConditionLogic>
            <exitConditionLogic>and</exitConditionLogic>
            <inputParameters>
                <name>ECCRecord</name>
                <value>
                    <elementReference>$Record</elementReference>
                </value>
            </inputParameters>
            <label>Update ECC Process Status Flow</label>
            <requiresAsyncProcessing>false</requiresAsyncProcessing>
            <runAsUser>false</runAsUser>
            <stepSubtype>BackgroundStep</stepSubtype>
        </stageSteps>
    </orchestratedStages>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>AUTO_LAYOUT_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>Orchestrator</processType>
    <start>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <connector>
            <targetReference>Get_Related_Record_Information</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Training_Sent_Date__c</field>
            <operator>IsNull</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <filters>
            <field>POE_Program__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Verizon Fios D2D</stringValue>
            </value>
        </filters>
        <object>POE_External_Contact_Credential__c</object>
        <recordTriggerType>Update</recordTriggerType>
        <triggerType>RecordAfterSave</triggerType>
    </start>
    <status>Active</status>
</Flow>
